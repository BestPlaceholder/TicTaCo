language: java
jdk:
- openjdk7
env:
  global:
  - HEROKU_STAGING_APP=tictaco-staging
  - GIT_REPO=TicTaCo
  - GIT_USER=HafdisE
  - secure: HyIzXv2iccD6JWGNgpk6yh0SuzJOg9x0qzF9rKfnOIUJSMlum0vPZbJ9/NJdrFJRaRA0/gsmP7cdzbGfZltgGi2Qsluso+GmPwhAaDU/5RWauEAR3c9Wf4OCZCSJa+imtK9bTHf7W/m3h7c6o3Hhi8YHoiSC9QQj2s27H+EcvSg=
  - secure: fIcImTCmjyPe6n5kA27NFdFHYE+/bFR7mK6ud/LQIRfKrcrV2pTKryTN4pw7xwc3Mr7D4H2O08SD/cxtN4aYqt/Gr4s8Pj5xctNZIQKc5rTjoAtGS/DIyDx5as595vSMiZEffuizSCDy/xCsyzVFb4XWipiZG79mILGYsDb9gsQ=
before_script:
- gem install heroku
- echo "Host heroku.com" >> ~/.ssh/config
- echo "   StrictHostKeyChecking no" >> ~/.ssh/config
- echo "   CheckHostIP no" >> ~/.ssh/config
- echo "   UserKnownHostsFile=/dev/null" >> ~/.ssh/config
script:
- ./gradlew check
- git remote add heroku git@heroku.com:$HEROKU_STAGING_APP.git
- heroku keys:clear
- yes | heroku keys:add
- yes | git push heroku master
- sleep 20s
- ./gradlew seleniumXvfb
after_success:
- ./gradlew jacocoTestReport
- ./bin/update-gh-pages
deploy:
- provider: heroku
  api_key: $HEROKU_API_KEY
  strategy: git
  app:
    master: tictaco
